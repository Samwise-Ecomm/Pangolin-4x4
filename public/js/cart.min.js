function changeCartItem(g,f,e,b,d,a){cart=returnCart();newItem=true;for(var c=0;c<cart.length;c++){if(cart[c]["id"]==g){if(cart[c]["avl"]=="∞"||cart[c]["cnt"]+f<=cart[c]["avl"]){cart[c]["cnt"]=cart[c]["cnt"]+f}newItem=false;break}}if(newItem&&typeof(e)=="number"&&typeof(b)=="string"&&typeof(d)=="number"&&(typeof(a)=="number"||a=="∞")){if(a=="∞"||f<=a){cart.push({id:g,pId:e,cnt:f,name:b,pri:d,avl:a})}}sessionStorage.cart=JSON.stringify(cart);fillCart()}function newCartCnt(c,b){cart=returnCart();for(var a=0;a<cart.length;a++){if(cart[a]["id"]==c){if(cart[a]["avl"]=="∞"||b<=cart[a]["avl"]){cart[a]["cnt"]=b}break}}sessionStorage.cart=JSON.stringify(cart)}function returnCart(){if(typeof(sessionStorage.cart)=="undefined"){return[]}else{return JSON.parse(sessionStorage.cart)}}function fillCart(){cart=returnCart();var b="";b+="<div id='Cart-head'>Cart</div>";$(".js-addToCart.inCatalog").each(function(){var e=$("#"+$(this).data("pid")+"-variations option:selected");if(e.data("avl")==0){$(this).html("Out of Stock");$(this).addClass("isDisabled");return}$(this).html("<i class='fa fa-shopping-cart'></i> Add to Cart");$(this).removeClass("isDisabled");for(var d=0;d<cart.length;d++){if(e.data("id")==cart[d]["id"]){cart[d]["pId"]=e.data("pid");cart[d]["name"]=e.data("name");cart[d]["pri"]=e.data("pri");cart[d]["avl"]=e.data("avl");if(cart[d]["cnt"]==0){$(this).html("<i class='fa fa-shopping-cart'></i> Add to Cart");$(this).removeClass("isDisabled")}else{if(e.data("avl")!="∞"&&e.data("avl")<=cart[d]["cnt"]){cart[d]["cnt"]=e.data("avl");$(this).html("All In Cart ("+cart[d]["cnt"]+")");$(this).addClass("isDisabled")}else{$(this).html("<i class='fa fa-cart-plus'></i> "+cart[d]["cnt"]+" In Cart");$(this).removeClass("isDisabled")}}break}}});var a=0;for(var c=0;c<cart.length;c++){if(c!=0){b+="<hr>"}b+="<div class='Cart-item'>";id=cart[c]["id"];cnt=cart[c]["cnt"];$(".js-addToCart.inVariations").each(function(){if($(this).data("id")==id){cart[c]["pId"]=$(this).data("pid");cart[c]["name"]=$(this).data("name");cart[c]["pri"]=$(this).data("pri");cart[c]["avl"]=$(this).data("avl");if(cnt==0){$(this).html("<i class='fa fa-shopping-cart'></i> Add to Cart");$(this).removeClass("isDisabled")}else{if($(this).data("avl")!="∞"&&$(this).data("avl")<=cnt){cart[c]["cnt"]=$(this).data("avl");cnt=cart[c]["cnt"];$(this).html("All In Cart ("+cnt+")");$(this).addClass("isDisabled")}else{$(this).html("<i class='fa fa-cart-plus'></i> "+cnt+" In Cart");$(this).removeClass("isDisabled")}}}});name=cart[c]["name"].replace(/\\n/g,":<br>");pId=cart[c]["pId"];itemTotal=cart[c]["pri"].toFixed(2);availible=cart[c]["avl"];a+=itemTotal*cnt;if(cnt>0){sub=" u-active' onmousedown='changeCartItem("+id+",-1)'"}else{sub="-o'"}if(availible=="∞"||cnt<availible){add=" u-active' onmousedown='changeCartItem("+id+",1)'"}else{add="-o'"}b+="<a href='/item.php?id="+pId+"'><h5>"+name+"</h5></a>";b+="<h6 class='u-inline'>$"+itemTotal+"</h6>";b+="<span class='u-floatRight'><i class='fa fa-minus-square"+sub+"'></i> "+cnt+" <i class='fa fa-plus-square"+add+"'></i></span>";b+="</div>"}b+="<a href='/checkout.php'><div id='Cart-foot' class='u-active'><b>Subtotal:</b> $"+a.toFixed(2)+"<b class='u-floatRight'>Checkout</b></div></a>";$("#Cart").html(b);sessionStorage.cart=JSON.stringify(cart)}function clearCart(){sessionStorage.cart="[]";$(".js-addToCart").html('<i class="fa fa-shopping-cart"></i> Add to Cart');$(".js-addToCart").removeClass("isDisabled");$("#Cart").html("")}function cleanCart(){cart=returnCart();for(var a=cart.length-1;a>=0;a--){if(cart[a]["cnt"]==0){if(a==cart.length-1){cart=cart.slice(0,a)}else{cart=cart.slice(0,a).concat(cart.slice(a+1))}}}sessionStorage.cart=JSON.stringify(cart)}function connectCatalog(){$(".js-addToCart").mousedown(function(){if($(this).data("variants")){var f=$("#"+$(this).data("pid")+"-variations option:selected");var g=f.data("id");var e=1;var d=f.data("pid");var b=f.data("name");var c=f.data("pri");var a=f.data("avl")}else{var g=$(this).data("id");var e=1;var d=$(this).data("pid");var b=$(this).data("name");var c=$(this).data("pri");var a=$(this).data("avl")}changeCartItem(g,e,d,b,c,a)});$(".CatalogItem-variations").change(function(){fillCart()});if(sessionStorage.cart!="[]"){fillCart()}};